<!DOCTYPE html>
<html lang="fr" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EgoCoach Phoenix</title>
    <meta name="description" content="Outil d'analyse et d'aide à la communication interpersonnelle.">
    <link rel="icon" type="image/png" href="favicon.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="EgoCoach">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">

    <!-- Theme Color -->
    <meta name="theme-color" content="#0891b2">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0f172a">


    <script>
        // Suppress Tailwind CDN warning - MUST be before Tailwind loads
        if (typeof console !== 'undefined' && console.warn) {
            const originalWarn = console.warn;
            console.warn = function (...args) {
                if (args[0] && typeof args[0] === 'string' && args[0].includes('cdn.tailwindcss.com')) {
                    return; // Suppress this specific warning
                }
                originalWarn.apply(console, args);
            };
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        };
    </script>


    <!-- Legacy CSS (to be refactored later if needed) -->
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/modules.css">
    <link rel="stylesheet" href="assets/css/animations.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body class="bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100 min-h-screen overflow-x-hidden">

    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="splash-logo">
            <i data-lucide="sparkles" class="w-16 h-16"></i>
            <h1>EgoCoach</h1>
        </div>
        <div class="splash-loader"></div>
    </div>

    <h1 class="text-sm font-bold text-slate-900 dark:text-white">EgoCoach</h1>
    <p class="text-xs text-slate-500">Phoenix v2.0</p>
    </div>
    </div>
    </div>

    <nav class="p-3 space-y-5 overflow-y-auto h-[calc(100vh-3.5rem)]">
        <div>
            <p class="px-3 text-[10px] font-semibold text-slate-400 uppercase tracking-wider mb-2">Principal</p>
            <div class="space-y-0.5">
                <a href="#home" data-link
                    class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                    Tableau de bord
                </a>
                <a href="#journal" data-link
                    class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <i data-lucide="book" class="w-5 h-5"></i>
                    Mon Journal
                </a>
            </div>
        </div>

        <div>
            <p class="px-4 text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Analyser</p>
            <div class="space-y-1">
                <a href="#analyze" data-link
                    class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <i data-lucide="zap" class="w-5 h-5"></i>
                    Analyseur
                </a>
            </div>
        </div>

        <div>
            <p class="px-4 text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Entraînement</p>
            <div class="space-y-1">
                <a href="#dojo" data-link
                    class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <i data-lucide="swords" class="w-5 h-5"></i>
                    Dojo
                </a>
                <a href="#guide" data-link
                    class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <i data-lucide="book-open" class="w-5 h-5"></i>
                    Guide
                </a>
            </div>
        </div>
    </nav>
    <div class="p-4 border-t border-slate-200 dark:border-slate-800">
        <button id="open-settings-btn"
            class="flex items-center gap-3 px-4 py-2 w-full text-sm font-medium rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
    </div>

    <div class="flex items-center gap-2">
        <button id="settings-btn"
            class="p-2 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors"
            title="Paramètres">
            <i data-lucide="settings" class="w-5 h-5"></i>
        </button>
        <button id="theme-toggle"
            class="p-2 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors"
            title="Changer le thème">
            <i id="theme-toggle-dark-icon" data-lucide="moon" class="w-5 h-5 block dark:hidden"></i>
            <i id="theme-toggle-light-icon" data-lucide="sun" class="w-5 h-5 hidden dark:block"></i>
        </button>
    </div>
    </header>

    <!-- App Root -->
    <div id="app-root" class="flex-1 p-6">
        <!-- Components will be mounted here -->
    </div>
    </main>
    </div><!-- End App Container -->

    <!-- Modals Placeholder -->
    <!-- Toast Container -->
    <div id="toast-root" class="fixed bottom-4 right-4 z-50 flex flex-col gap-2 pointer-events-none"></div>

    <!-- Protocol Check & Entry Point -->
    <script>
        // Check if running via file:// protocol
        if (window.location.protocol === 'file:') {
            const root = document.getElementById('app-root');
            if (root) {
                root.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full text-center p-8">
                        <div class="bg-red-50 dark:bg-red-900/20 p-6 rounded-2xl max-w-lg">
                            <div class="h-14 flex items-center px-4 border-b border-slate-200 dark:border-slate-800">
                                <div class="flex items-center gap-2">
                                    <div class="w-7 h-7 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-lg flex items-center justify-center text-white shrink-0">
                                        <i data-lucide="sparkles" class="w-4 h-4"></i>
                                    </div>
                                    <div>
                                        <h1 class="text-xs font-bold text-slate-900 dark:text-white leading-tight">EgoCoach</h1>
                                        <p class="text-[10px] text-slate-500 leading-tight">Phoenix</p>
                                    </div>
                                </div>
                            </div>
                            <div class="w-16 h-16 bg-red-100 dark:bg-red-900/50 rounded-full flex items-center justify-center mx-auto mb-4 text-red-600 dark:text-red-400">
                                <i data-lucide="alert-triangle" class="w-8 h-8"></i>
                            </div>
                            <h2 class="text-xl font-bold text-slate-900 dark:text-white mb-2">Mode de lancement incorrect</h2>
                            <p class="text-slate-600 dark:text-slate-300 mb-6">
                                L'application ne peut pas fonctionner en ouvrant directement le fichier (<code>file://</code>) pour des raisons de sécurité (CORS/Modules).
                            </p>
                            <div class="text-left bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-200 dark:border-slate-700 mb-6">
                                <p class="text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Comment lancer l'application :</p>
                                <ol class="list-decimal list-inside text-sm text-slate-600 dark:text-slate-400 space-y-2">
                                    <li>Ouvrez un terminal dans le dossier du projet</li>
                                    <li>Lancez un serveur local :
                                        <code class="block mt-1 bg-slate-100 dark:bg-slate-900 p-2 rounded text-blue-600 dark:text-blue-400 font-mono">python3 -m http.server</code>
                                        <span class="text-xs text-slate-500 block mt-1">ou si vous avez Node.js :</span>
                                        <code class="block mt-1 bg-slate-100 dark:bg-slate-900 p-2 rounded text-blue-600 dark:text-blue-400 font-mono">npx serve</code>
                                    </li>
                                    <li>Ouvrez l'URL affichée (ex: http://localhost:8000)</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                `;
                // Initialize icons for the error message
                if (window.lucide) lucide.createIcons();
            }
        }

        // Sidebar toggle logic is handled in app.js
    </script>

    <!-- Main Module Loader -->
    <script type="module" src="assets/js/core/app.js"></script>
</body>

</html>